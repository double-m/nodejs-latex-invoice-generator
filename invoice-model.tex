\documentclass[a4paper]{report}

\usepackage[utf8]{inputenc}
\usepackage[italian]{babel}
\usepackage{/usr/share/texlive/texmf-dist/tex/latex/fancyhdr/fancyhdr}
\usepackage{lmodern,textcomp}
\usepackage{eurosym}
\usepackage{blindtext}
\usepackage[nomessages]{fp}
\usepackage{ifthen}
\usepackage{ragged2e}

\input{./locales/italian.def}
\input{./values.def}

\pagestyle{fancy}

\author{Name Surname}

% Default english expressions
\providecommand{\ClientHeading}          {Billed to}
\providecommand{\InvoiceNumberText}      {Invoice no.}
\providecommand{\VatName}                {VAT}

\providecommand{\HeadActivity}           {Activity}
\providecommand{\HeadAmount}             {Amount}
\providecommand{\FootTotal}              {Total}

\vspace{10 mm}

% Default values
\providecommand{\ClientName}             {COMPANY NAME}
\providecommand{\ClientAddress}          {ADDRESS}
\providecommand{\ClientCity}             {CITY, STATE}
\providecommand{\ClientVat}              {VAT\_CODE}

\providecommand{\InvoiceNumberValue}     {0}
\providecommand{\InvoiceDate}            {\today}

\providecommand{\ActivityDescription}    {\blindtext}
\providecommand{\ActivityFee}            {0.00}

\providecommand{\OptionalTaxDescription} {OPTIONAL TAX}
\providecommand{\OptionalTaxRate}        {10}

\providecommand{\FootNote}               {}
\providecommand{\FootNoteTreshold}       {}

% Calculated values
\def \ClientVatOut                       {\VatName:\ \ClientVat}
\def \InvoiceNumberOut                   {\InvoiceNumberText\ \InvoiceNumberValue}
\def \OptionalTaxDescOut                 {\OptionalTaxDescription\ (\OptionalTaxRate\%)}
\FPeval{\OptionalTaxAmount}              {round(\ActivityFee * \OptionalTaxRate / 100, 2)}
\FPeval{\CalculatedTotal}                {round(\ActivityFee + \OptionalTaxAmount, 2)}

% Compose the header
\makeatletter

\lhead{}
\chead{\scshape\large \@author}
\rhead{}

\lfoot{}
\cfoot{}
\rfoot{}

\ifthenelse{\equal{\FootNote}{}}{}{
  \lfoot{\small\FootNote
    \ifthenelse{\equal{\FootNoteTreshold}{}}
      {}
      {\FPeval{\tresh}{round(\CalculatedTotal * 100 - \Treshold * 100, 0)}
      \ifthenelse{\tresh>0}
        {\FootNoteTreshold}
        {}
      }
  }
}

\linespread{1.5}

% Compose the body
\begin{document}

\begin{minipage}[t]{\textwidth}
  \begin{verse}
    \begin{flushright}
      \begin{tabular}{rl}
        \ClientHeading & \textbf{\ClientName}
        \\
        & \ClientAddress
        \\
        & \ClientCity
        \\
        & \ClientVatOut
      \end{tabular}
    \end{flushright}
  \end{verse}
\end{minipage}

\vspace{10 mm}

\begin{minipage}[t]{\textwidth}
  \begin{flushleft}
    \begin{tabular}{r}
      \InvoiceNumberOut
      \\
      \InvoiceDate
    \end{tabular}
  \end{flushleft}
\end{minipage}

\vspace{10 mm}

\noindent
\begin{tabular*}{\textwidth}{p{9cm} @{\extracolsep{\fill}} r}
  \textbf{\HeadActivity} & \textbf{\HeadAmount} \\
  \hline
  & \\

  {\setlength{\baselineskip}{0.7\baselineskip}
    \ActivityDescription \par
  }
  & \ActivityFee \texteuro

  \ifthenelse{\equal{\OptionalTaxRate}{0}}{\\}{
    \\
    {\setlength{\baselineskip}{0.7\baselineskip}
      \OptionalTaxDescOut \par
    }
    & \OptionalTaxAmount \texteuro
    \\
  }

  \hline
  \textbf{\FootTotal} & \textbf{\CalculatedTotal \texteuro}
\end{tabular*}

% TODO line for the signature
%\vspace{10 mm}

\end{document}

